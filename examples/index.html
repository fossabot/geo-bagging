<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		
		<!-- must be first -->
		<script src='../js/error_handler.js'></script>

		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.0/dist/leaflet.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/Leaflet/Leaflet.markercluster/232e93ccbe5b70241913f47a4d1a8ceec8c88c30/dist/MarkerCluster.Default.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/Leaflet/Leaflet.markercluster/232e93ccbe5b70241913f47a4d1a8ceec8c88c30/dist/MarkerCluster.css" />
		<!-- Add the moment it's safe to load these at the same time because there are no conflicts and the styles will only be used if the particular control is in play -->
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/Leaflet.MapCenterCoord/cc990a672930886aaef55b1a66e651bdaaf27353/src/L.Control.MapCenterCoord.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/Leaflet.MousePosition/b628c7be754c134c63117b3feb75e720a1d20673/src/L.Control.MousePosition.css" />
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/leaflet.locatecontrol/0.52.0/L.Control.Locate.min.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/Leaflet.MatrixLayersControl/e7ac6e05a4ae27c9da1849f336440de4fde37139/src/matrixControl.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/Leaflet.ControlHider/3df76ebbfda70789027a40aa6f2e05db603aa364/src/hider.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/Leaflet.BoxSelector/d0f8184abafc17170ccc41a98cd6091882683ddf/src/selector.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/tstibbs/L.GeoSearch/01854d273650a4b5b28e53e7852257280a25a010/src/css/l.geosearch.css" />
		<link rel="stylesheet" href="../css/app.css" />
		
		<script src='https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.js'></script>
		<script src='../js/loader.js'></script>
		<script type="text/javascript">
			window.os_map_base = '../';
			var options = {
				cluster: false,
				dimensional_layering: false,
				page_id: 'all'
			};
			var bundleIds = [];
			if (window.location.search.indexOf('hills=true') != -1) {
				bundleIds.push('hills/config');
			}
			if (window.location.search.indexOf('trigs=true') != -1) {
				bundleIds.push('trigs/config_all');
			}
			if (window.location.search.indexOf('milestones=true') != -1) {
				bundleIds.push('milestones/config');
			}
			loadOsMap(bundleIds, function(main, bundles) {
				if (bundleIds.length > 0) {
					options.cluster = true;
					options.dimensional_layering = true;
					main.buildMapWithBundleDatas(options, bundles);
				} else if (main.hasUrlData()) {
					main.buildMapFromUrl(options);
				} else {
					main.buildMapWithDummyData(options);
				}
			});
		</script>
	</head>

	<body class="full-screen">
		<div id="error-container" style="display: none;">
			<p class="title">Some errors have occurred:</p>
			<div id="errors-list"></div>
			<a id="dismiss-button" href="#">Hide</a>
		</div>
		<div id="loading-message-pane" class="full-screen">
			<div class="loading-message-container">
				<div class="loading-message-text">
					<p>Loading...</p>
				</div>
			</div>
		</div>
		<div id="map" class="full-screen"></div>
	</body>
</html>
